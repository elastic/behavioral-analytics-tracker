"use strict";var elasticAnalyticsDefault=(()=>{var h=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var _=Object.prototype.hasOwnProperty;var U=(t,e)=>{for(var r in e)h(t,r,{get:e[r],enumerable:!0})},y=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of x(e))!_.call(t,s)&&s!==r&&h(t,s,{get:()=>e[s],enumerable:!(i=A(e,s))||i.enumerable});return t};var D=t=>y(h({},"__esModule",{value:!0}),t);var N={};U(N,{default:()=>C});var m=(t,e)=>{let r=document.referrer||"";return t==="page_view"?{...e,page:{...e.page||{},referrer:r,url:window.location.href,title:document.title}}:e};var P={pageAttributes:m};function a(t){var i;let r=("; "+document.cookie).split("; "+t+"=");if(r.length===2&&r[1])return(i=r.pop())==null?void 0:i.split(";").shift()}function E(t,e,r,i="/"){var s="expires="+r.toUTCString();document.cookie=t+"="+e+"; "+s+"; path="+i}function l(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})}var L=1,O=24*60*60*1e3,T=30*60*1e3,R=T,o="EA_UID",k="EA_SID",g="EA_SESSION_SAMPLED",d=class{constructor(e){this.userToken=e.user.token||a(o)||l(),this.userTokenExpirationInterval=e.user.lifetime||O,this.sessionTokenExpirationInterval=e.session.lifetime||T,this.sampling=e.sampling===void 0?L:e.sampling,a("EA_SESSION_SAMPLED")||this.updateSessionSampledExpire(),this.userToken!==a(o)&&this.updateUserExpire()}getUserUuid(){let e=a(o);return e||(this.updateUserExpire(),e=a(o)),e}isSessionSampled(){return a(g)=="true"}updateSessionSampledExpire(){let e=a(g)||(Math.random()<=this.sampling).toString(),r=new Date;r.setMilliseconds(R),E(g,e,r)}getSessionUuid(){return a(k)}updateSessionExpire(){let e=a(k)||l(),r=new Date;r.setMilliseconds(this.sessionTokenExpirationInterval),E(k,e,r)}updateUserExpire(){let e=new Date;e.setMilliseconds(this.userTokenExpirationInterval),E(o,this.userToken,e)}};var b=(t,e,r)=>Object.values(r).reduce((i,s)=>s(t,i),{...e}),p=class{constructor(e){var r,i,s,c;this.apiURL=`${e.endpoint}/_application/analytics/${e.collectionName}/event`,this.apiKey=e.apiKey,this.debug=e.debug||!1,this.userSessionStore=new d({user:{token:typeof((r=e.user)==null?void 0:r.token)=="function"?e.user.token():(i=e.user)==null?void 0:i.token,lifetime:(s=e.user)==null?void 0:s.lifetime},session:{lifetime:(c=e.session)==null?void 0:c.lifetime},sampling:e.sampling}),this.dataProviders={...P,...e.dataProviders||{}}}trackEvent(e,r){if(this.userSessionStore.updateSessionExpire(),this.userSessionStore.updateSessionSampledExpire(),!this.userSessionStore.isSessionSampled())return;let i=this.getUserSession(),s=b(e,{...r,...i},this.dataProviders),c=JSON.stringify(s),I=this.debug?"?debug=true":"",w=`${this.apiURL}/${e}${I}`,u=new XMLHttpRequest;u.open("POST",w,!0),u.setRequestHeader("Content-Type","application/json"),u.setRequestHeader("Authorization",`Apikey ${this.apiKey}`),u.send(c)}trackPageView(e){this.trackEvent("page_view",e||{})}trackSearchClick(e){this.trackEvent("search_click",e)}trackSearch(e){this.trackEvent("search",e)}getUserSession(){return{user:{id:this.userSessionStore.getUserUuid()},session:{id:this.userSessionStore.getSessionUuid()}}}};var n,S=[],f={createTracker:t=>(n=new p(t),S.forEach(([e,r])=>{n==null||n.trackEvent(e,r)}),n),trackPageView:t=>{if(!n){S.push(["page_view",{}]);return}n.trackPageView(t)},trackSearchClick:t=>{if(!n){S.push(["search_click",t]);return}n.trackSearchClick(t)},trackSearch:t=>{if(!n){S.push(["search",t]);return}n.trackSearch(t)}},v=()=>{f.trackPageView({})};window.addEventListener("pageshow",v);if(window.history){let t=window.history.pushState;window.history.pushState=(...e)=>(window.dispatchEvent(new Event("ewt:pushstate")),t.apply(window.history,e)),window.addEventListener("ewt:pushstate",v),window.addEventListener("popstate",v)}else window.addEventListener("hashchange",v);var C=f;return D(N);})();
var elasticAnalytics = elasticAnalyticsDefault.default
