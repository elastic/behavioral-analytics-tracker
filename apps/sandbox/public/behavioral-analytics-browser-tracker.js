"use strict";var elasticAnalyticsDefault=(()=>{var E=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var x=Object.prototype.hasOwnProperty;var y=(t,e)=>{for(var r in e)E(t,r,{get:e[r],enumerable:!0})},U=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of m(e))!x.call(t,s)&&s!==r&&E(t,s,{get:()=>e[s],enumerable:!(i=I(e,s))||i.enumerable});return t};var A=t=>U(E({},"__esModule",{value:!0}),t);var C={};y(C,{default:()=>O});var g=(t,e)=>{let r=document.referrer||"";return{...e,page:{...e.page||{},referrer:r,url:window.location.href,title:document.title}}};var P={pageAttributes:g};function o(t){var i;let r=("; "+document.cookie).split("; "+t+"=");if(r.length===2&&r[1])return(i=r.pop())==null?void 0:i.split(";").shift()}function h(t,e,r,i="/"){var s="expires="+r.toUTCString();document.cookie=t+"="+e+"; "+s+"; path="+i}function l(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})}var _=24*60*60*1e3,R=30*60*1e3,a="EA_UID",S="EA_SID",v=class{constructor(e){this.userToken=e.user.token||o(a)||l(),this.userTokenExpirationInterval=e.user.lifetime||_,this.sessionTokenExpirationInterval=e.session.lifetime||R,this.userToken!==o(a)&&this.updateUserExpire()}getUserUuid(){let e=o(a);return e||(this.updateUserExpire(),e=o(a)),e}getSessionUuid(){return o(S)}updateSessionExpire(){let e=o(S)||l(),r=new Date;r.setMilliseconds(this.sessionTokenExpirationInterval),h(S,e,r)}updateUserExpire(){let e=new Date;e.setMilliseconds(this.userTokenExpirationInterval),h(a,this.userToken,e)}};var D=(t,e,r)=>Object.values(r).reduce((i,s)=>s(t,i),{...e}),p=class{constructor(e){var r,i,s,c;this.apiURL=`${e.endpoint}/_application/analytics/${e.collectionName}/event`,this.apiKey=e.apiKey,this.debug=e.debug||!1,this.userSessionStore=new v({user:{token:typeof((r=e.user)==null?void 0:r.token)=="function"?e.user.token():(i=e.user)==null?void 0:i.token,lifetime:(s=e.user)==null?void 0:s.lifetime},session:{lifetime:(c=e.session)==null?void 0:c.lifetime}}),this.dataProviders={...P,...e.dataProviders||{}}}trackEvent(e,r){this.userSessionStore.updateSessionExpire();let i=this.getUserSession(),s=D(e,{...r,...i},this.dataProviders),c=JSON.stringify(s),f=this.debug?"?debug=true":"",w=`${this.apiURL}/${e}${f}`,u=new XMLHttpRequest;u.open("POST",w,!0),u.setRequestHeader("Content-Type","application/json"),u.setRequestHeader("Authorization",`Basic ${this.apiKey}`),u.send(c)}trackPageView(e){this.trackEvent("page_view",e||{})}trackSearchClick(e){this.trackEvent("search_click",e)}trackSearch(e){this.trackEvent("search",e)}getUserSession(){return{user:{id:this.userSessionStore.getUserUuid()},session:{id:this.userSessionStore.getSessionUuid()}}}};var n,d=[],T={createTracker:t=>(n=new p(t),d.forEach(([e,r])=>{n==null||n.trackEvent(e,r)}),n),trackPageView:t=>{if(!n){d.push(["page_view",{}]);return}n.trackPageView(t)},trackSearchClick:t=>{if(!n){d.push(["search_click",t]);return}n.trackSearchClick(t)},trackSearch:t=>{if(!n){d.push(["search",t]);return}n.trackSearch(t)}},k=()=>{T.trackPageView({})};window.addEventListener("pageshow",k);if(window.history){let t=window.history.pushState;window.history.pushState=(...e)=>(window.dispatchEvent(new Event("ewt:pushstate")),t.apply(window.history,e)),window.addEventListener("ewt:pushstate",k),window.addEventListener("popstate",k)}else window.addEventListener("hashchange",k);var O=T;return A(C);})();
var elasticAnalytics = elasticAnalyticsDefault.default
